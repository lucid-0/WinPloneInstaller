
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WinPloneInstaller.py &#8212; WinPloneInstaller  documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="winploneinstaller-py">
<span id="winploneinstaller"></span><h1>WinPloneInstaller.py<a class="headerlink" href="#winploneinstaller-py" title="Permalink to this headline">¶</a></h1>
<p>WinPloneInstaller.py contains the main logic of the installer. <a class="reference internal" href="PyInstaller.html#pyinstaller"><span class="std std-ref">PyInstaller</span></a> is used to convert this file to an executable that includes its dependencies. There are plenty of comments inside the file to help understand what it is doing, but the basic strategy is:</p>
<ul class="simple">
<li>Check if our Windows registry key already exists.<ul>
<li>If so, read it in and call the appropriate function to continue installation.</li>
<li>If not, initialize it to “begin” and display the GUI</li>
</ul>
</li>
<li>User selects Linux Subsystem or Standard Buildout installation</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>If Linux Subsystem is chosen and user has up to date Windows 10:<ul>
<li>Enable and install the Windows Subsystem for Linux</li>
<li>Run bash script which retrieves and runs the universal installer</li>
</ul>
</li>
<li>If Standard Buildout is chosen<ul>
<li>Install <span class="xref std std-ref">chocolatey</span> (a software manager for Windows)</li>
<li>Use to install Python, Git, etc.</li>
<li>Run buildout</li>
</ul>
</li>
</ul>
</div></blockquote>
<p>The process is generally to call out (to PowerShell for example) for an action, and then wait for the Windows registry to reflect progress. wait_for_status_change(timeout) function takes an integer and allows that many attempts in reading the registry for status updates. There is a 2 second pause in the registry query code to prevent an overflow of registry reads, so currently a timeout value of 15 attempts will leave around 30 seconds for the external process to complete. wait_for_status_change(timeout) is generally called after each call to run_PS(scriptName)</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/WinPloneInstaller.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, WinPloneInstaller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/WinPloneInstaller.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>